<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example 8: KANs’ Scaling Laws &mdash; Kolmogorov Arnold Network  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example 9: Singularity" href="Example_9_singularity.html" />
    <link rel="prev" title="Example 7: Continual Learning" href="Example_7_continual_learning.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Kolmogorov Arnold Network
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Hello, KAN!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos.html">API Demos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Example_1_function_fitting.html">Example 1: Function Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_2_deep_formula.html">Example 2: Deep Formulas</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_3_classfication.html">Example 3: Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_4_symbolic_regression.html">Example 4: Symbolic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_5_special_functions.html">Example 5: Special functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_6_PDE.html">Example 6: Solving Partial Differential Equation (PDE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_7_continual_learning.html">Example 7: Continual Learning</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 8: KANs’ Scaling Laws</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_9_singularity.html">Example 9: Singularity</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_10_relativity-addition.html">Example 10: Use of lock for Relativity Addition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_11_encouraing_linear.html">Example 11: Encouraging linearity</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_12_unsupervised_learning.html">Example 12: Unsupervised learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_13_phase_transition.html">Example 13: Phase transition</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Kolmogorov Arnold Network</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Example 8: KANs’ Scaling Laws</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Examples/Example_8_scaling.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="example-8-kans-scaling-laws">
<h1>Example 8: KANs’ Scaling Laws<a class="headerlink" href="#example-8-kans-scaling-laws" title="Link to this heading"></a></h1>
<p>In this example, we show KAN’s scaling laws (wrt model params and data
size)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from kan import *

# initialize KAN with G=3
model = KAN(width=[2,1,1], grid=3, k=3)

data_sizes = np.array([100,300,1000,3000])
grids = np.array([5,10,20,50,100])

train_losses = np.zeros((data_sizes.shape[0], grids.shape[0]))
test_losses = np.zeros((data_sizes.shape[0], grids.shape[0]))
steps = 50
k = 3

for j in range(data_sizes.shape[0]):
    data_size = data_sizes[j]
    print(f&#39;data_size={data_size}&#39;)
    # create dataset
    f = lambda x: torch.exp(torch.sin(torch.pi*x[:,[0]]) + x[:,[1]]**2)
    dataset = create_dataset(f, n_var=2, train_num=data_size)

    for i in range(grids.shape[0]):
        print(f&#39;grid_size={grids[i]}&#39;)
        if i == 0:
            model = KAN(width=[2,1,1], grid=grids[i], k=k)
        if i != 0:
            model = KAN(width=[2,1,1], grid=grids[i], k=k).initialize_from_another_model(model, dataset[&#39;train_input&#39;])
        results = model.train(dataset, opt=&quot;LBFGS&quot;, steps=steps, stop_grid_update_step = 30)
        train_losses[j][i] = results[&#39;train_loss&#39;][-1]
        test_losses[j][i] = results[&#39;test_loss&#39;][-1]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_size</span><span class="o">=</span><span class="mi">100</span>
<span class="n">grid_size</span><span class="o">=</span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 5.22e-03 | test loss: 7.32e-03 | reg: 2.91e+00 : 100%|██| 50/50 [00:07&lt;00:00,  7.10it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.20e-04 | test loss: 8.06e-04 | reg: 2.90e+00 : 100%|██| 50/50 [00:06&lt;00:00,  7.48it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 7.01e-06 | test loss: 3.07e-04 | reg: 2.90e+00 : 100%|██| 50/50 [00:07&lt;00:00,  6.73it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">50</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 1.97e-04 | test loss: 3.15e-02 | reg: 2.90e+00 : 100%|██| 50/50 [00:07&lt;00:00,  6.45it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">100</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.00e-03 | test loss: 1.65e+00 | reg: 3.05e+00 : 100%|██| 50/50 [00:07&lt;00:00,  6.35it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_size</span><span class="o">=</span><span class="mi">300</span>
<span class="n">grid_size</span><span class="o">=</span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 5.80e-03 | test loss: 6.71e-03 | reg: 2.88e+00 : 100%|██| 50/50 [00:06&lt;00:00,  7.23it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 3.19e-04 | test loss: 3.15e-04 | reg: 2.89e+00 : 100%|██| 50/50 [00:06&lt;00:00,  7.31it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 1.96e-05 | test loss: 2.34e-05 | reg: 2.89e+00 : 100%|██| 50/50 [00:07&lt;00:00,  6.67it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">50</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.08e-06 | test loss: 5.00e-06 | reg: 2.89e+00 : 100%|██| 50/50 [00:11&lt;00:00,  4.37it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">100</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.81e-07 | test loss: 3.41e-02 | reg: 2.89e+00 : 100%|██| 50/50 [00:17&lt;00:00,  2.83it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_size</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">grid_size</span><span class="o">=</span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 6.45e-03 | test loss: 6.44e-03 | reg: 2.91e+00 : 100%|██| 50/50 [00:07&lt;00:00,  6.72it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 4.14e-04 | test loss: 3.76e-04 | reg: 2.94e+00 : 100%|██| 50/50 [00:07&lt;00:00,  6.54it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 4.94e-05 | test loss: 4.69e-05 | reg: 2.93e+00 : 100%|██| 50/50 [00:14&lt;00:00,  3.44it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">50</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 5.21e-06 | test loss: 1.30e-05 | reg: 2.93e+00 : 100%|██| 50/50 [00:49&lt;00:00,  1.01it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">100</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.12e-06 | test loss: 1.05e-05 | reg: 2.93e+00 : 100%|██| 50/50 [01:15&lt;00:00,  1.51s/it]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_size</span><span class="o">=</span><span class="mi">3000</span>
<span class="n">grid_size</span><span class="o">=</span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 6.12e-03 | test loss: 6.77e-03 | reg: 2.79e+00 : 100%|██| 50/50 [00:16&lt;00:00,  2.99it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.98e-04 | test loss: 3.35e-04 | reg: 2.78e+00 : 100%|██| 50/50 [00:34&lt;00:00,  1.44it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 1.72e-05 | test loss: 1.86e-05 | reg: 2.78e+00 : 100%|██| 50/50 [00:38&lt;00:00,  1.31it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">50</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 3.97e-07 | test loss: 4.93e-07 | reg: 2.78e+00 : 100%|██| 50/50 [00:51&lt;00:00,  1.03s/it]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span><span class="o">=</span><span class="mi">100</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>train loss: 2.61e-08 | test loss: 3.27e-08 | reg: 2.78e+00 : 100%|██| 50/50 [00:26&lt;00:00,  1.85it/s]
</pre></div>
</div>
<p>Fix data size, study model (grid) size scaling. Roughly display
<span class="math notranslate nohighlight">\(N^{-4}\)</span> scaling.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for i in range(data_sizes.shape[0]):
    plt.plot(grids, train_losses[i,:], marker=&quot;o&quot;)
plt.xscale(&#39;log&#39;)
plt.yscale(&#39;log&#39;)
plt.plot(np.array([5,100]), 0.1*np.array([3,100])**(-4.), ls=&quot;--&quot;, color=&quot;black&quot;)
plt.legend([f&#39;data={data_sizes[i]}&#39; for i in range(data_sizes.shape[0])]+[r&#39;$N^{-4}$&#39;])
plt.ylabel(&#39;train RMSE&#39;)
plt.xlabel(&#39;grid size&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;grid size&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_8_scaling_4_1.png" src="../_images/Example_8_scaling_4_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for i in range(data_sizes.shape[0]):
    plt.plot(grids, test_losses[i,:], marker=&quot;o&quot;)
plt.xscale(&#39;log&#39;)
plt.yscale(&#39;log&#39;)
plt.plot(np.array([5,100]), 0.1*np.array([3,100])**(-4.), ls=&quot;--&quot;, color=&quot;black&quot;)
plt.legend([f&#39;data={data_sizes[i]}&#39; for i in range(data_sizes.shape[0])]+[r&#39;$N^{-4}$&#39;])
plt.ylabel(&#39;test RMSE&#39;)
plt.xlabel(&#39;grid size&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;grid size&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_8_scaling_5_1.png" src="../_images/Example_8_scaling_5_1.png" />
<p>Fix model (grid) size, study data size scaling. No clear power law
scaling. But we observe that: (1) increasing data size has no harm to
performance. (2) powerful model (larger grid size) can benefit more from
data size increase. Ideally one would want to increase data size and
model size together so that their complexity always match.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for i in range(grids.shape[0]):
    plt.plot(data_sizes, train_losses[:,i], marker=&quot;o&quot;)
plt.xscale(&#39;log&#39;)
plt.yscale(&#39;log&#39;)
plt.plot(np.array([100,3000]), 1e8*np.array([100,3000])**(-4.), ls=&quot;--&quot;, color=&quot;black&quot;)
plt.legend([f&#39;grid={grids[i]}&#39; for i in range(grids.shape[0])]+[r&#39;$N^{-4}$&#39;])
plt.ylabel(&#39;train RMSE&#39;)
plt.xlabel(&#39;data size&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;data size&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_8_scaling_7_1.png" src="../_images/Example_8_scaling_7_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for i in range(grids.shape[0]):
    plt.plot(data_sizes, test_losses[:,i], marker=&quot;o&quot;)
plt.xscale(&#39;log&#39;)
plt.yscale(&#39;log&#39;)
plt.plot(np.array([100,3000]), 1e5*np.array([100,3000])**(-4.), ls=&quot;--&quot;, color=&quot;black&quot;)
plt.legend([f&#39;grid={grids[i]}&#39; for i in range(grids.shape[0])]+[r&#39;$N^{-4}$&#39;])
plt.ylabel(&#39;test RMSE&#39;)
plt.xlabel(&#39;data size&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;data size&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_8_scaling_8_1.png" src="../_images/Example_8_scaling_8_1.png" />
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example_7_continual_learning.html" class="btn btn-neutral float-left" title="Example 7: Continual Learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Example_9_singularity.html" class="btn btn-neutral float-right" title="Example 9: Singularity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ziming Liu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>